YUI.add("aui-rating-base",function(e,t){var n=e.Lang,r=n.isBoolean,i=n.isNumber,s=n.isString,o=function(t){return t instanceof e.NodeList},u=function(t){return t instanceof e.Node},a="a",f="boundingBox",l="canReset",c="clearfix",h="contentBox",p="defaultSelected",d="disabled",v=".",m="element",g="elements",y="helper",b="hover",w="href",E="id",S="input",x="inputName",T="label",N="labelNode",t="name",C="nodeName",k="off",L="on",A="rating",O="selectedIndex",M="showTitle",_="size",D="",P="title",H="value",B="itemClick",j="itemOut",F="itemOver",I="itemSelect",q=e.getClassName,R=q("icon","star"),U=q("hide","text"),z=q("icon","star","empty"),W=q(A,T),X='<a class="{cssClasses}"></a>',V='<span class="'+W+'"></span>',$=e.Component.create({NAME:"rating",ATTRS:{disabled:{value:!1,validator:r},canReset:{value:!0,validator:r},cssClasses:{value:{element:z,hover:R,off:z,on:R}},defaultSelected:{value:0,writeOnce:!0,validator:i},elements:{validator:o},hiddenInput:{validator:u},inputName:{value:D,validator:s},label:{value:D,validator:s},labelNode:{valueFn:function(){return e.Node.create(V)},validator:u},selectedIndex:{value:-1,validator:i},showTitle:{value:!0,validator:r},size:{value:5,validator:function(e){return i(e)&&e>0}},title:null,value:null},HTML_PARSER:{elements:function(e){return e.all("a")},label:function(e){var t=e.one(v+W);if(t)return t.html()},labelNode:v+W},prototype:{BOUNDING_TEMPLATE:"<span></span>",CONTENT_TEMPLATE:"<span></span>",initializer:function(){var e=this;e.inputElementsData={},e.get(f).addClass(U),e.after("labelChange",this._afterSetLabel)},renderUI:function(){var e=this,t=e.get(h);e._parseInputElements(),e._renderLabel(),e._renderElements()},bindUI:function(){var e=this;e._createEvents(),e.on({click:e._handleClickEvent,mouseover:e._handleMouseOverEvent,mouseout:e._handleMouseOutEvent})},syncUI:function(){var e=this;e._syncElements(),e._syncLabelUI()},clearSelection:function(){var e=this,t=e.get("cssClasses");e.get(g).each(function(e){e.removeClass(t.on),e.removeClass(t.hover),e.addClass(t.element)})},select:function(e){var t=this,n=t.get(O),r=t.get(l);r&&n==e&&(e=-1),t.set(O,e);var i=t.get(O),s=t._getInputData(i),o=P in s?s.title:D,u=H in s?s.value:i;t.fillTo(i),t.set(P,o),t.set(H,u);var a=t.get("hiddenInput");a.setAttribute(P,o),a.setAttribute(H,u)},fillTo:function(e,t){var n=this,r=n.get("cssClasses");n.clearSelection(),e>=0&&n.get(g).some(function(n,i){return n.addClass(t||r.on),n.removeClass(r.element),i==Math.floor(e)})},indexOf:function(e){var t=this;return t.get(g).indexOf(e)},_canFireCustomEvent:function(e){var t=this,n=e.domEvent.target;return!t.get(d)&&n.test("a")},_createElements:function(){var t=this,r=t.get("cssClasses"),i=this.get(_),s=[];for(var o=0;o<i;o++)s.push(n.sub(X,{cssClasses:r.element}));return e.NodeList.create(s.join(D))},_createEvents:function(){var e=this,t=function(t,n){e.publish(t,{defaultFn:n,queuable:!1,emitFacade:!0,bubbles:!0})};t(B,this._defRatingItemClickFn),t(I,this._defRatingItemSelectFn),t(F,this._defRatingItemOverFn),t(j,this._defRatingItemOutFn)},_defRatingItemClickFn:function(e){var t=this,n=e.domEvent;t.fire(I,{delegateEvent:e,domEvent:n,ratingItem:n.target})},_defRatingItemSelectFn:function(e){var t=this,n=e.domEvent.target;t.select(t.indexOf(n))},_defRatingItemOutFn:function(e){var t=this;t.fillTo(t.get(O))},_defRatingItemOverFn:function(e){var t=this,n=t.get("cssClasses"),r=t.indexOf(e.domEvent.target);t.fillTo(r,n.hover)},_parseInputElements:function(){var n=this,r=n.get(f),i=r.all(S),s=i.size(),o=n.get(x),u=e.Node.create('<input type="hidden" />');if(s>0){o=o||i.item(0).getAttribute(t),n.set(_,s);var a=r.getElementsByTagName("label");i.each(function(e,t){var r=e.get(E),i=D;if(r){var s=a.filter('[for="'+r+'"]');s.size()&&(i=s.item(0).html())}n.inputElementsData[t]={content:i,value:e.getAttribute(H)||t,title:e.getAttribute(P)}}),a.remove(!0),i.remove(!0)}o&&(u.setAttribute(t,o),r.appendChild(u)),n.set("hiddenInput",u)},_renderLabel:function(){var e=this;e.get(h).setContent(e.get(N))},_renderElements:function(){var e=this,t=e.get(h),n=e.get(g);if(!n||!n.size())n=e._createElements(),e.set(g,n);n.each(function(t,n){var r=e._getInputData(n),i=r.content,s=r.title||e.get(P)||i;(i||s)&&t.html(i||s),s&&e.get(M)&&t.setAttribute(P,s),!t.attr(w)&&t.get(C).toLowerCase()==a&&t.setAttribute("onclick","return false;")}),t.append(n.getDOM())},_syncElements:function(){var e=this,t=e.get(p)-1;e.set(O,t),e.select()},_syncLabelUI:function(){var e=this,t=e.get(T);e.get(N).html(t)},_getInputData:function(e){var t=this;return t.inputElementsData[e]||{}},_handleClickEvent:function(e){var t=this,n=e.domEvent;t._canFireCustomEvent(e)?t.fire(B,{delegateEvent:e,domEvent:n}):n.preventDefault()},_handleMouseOutEvent:function(e){var t=this;t._canFireCustomEvent(e)&&t.fire(j,{delegateEvent:e,domEvent:e.domEvent})},_handleMouseOverEvent:function(e){var t=this;t._canFireCustomEvent(e)&&t.fire(F,{delegateEvent:e,domEvent:e.domEvent})},_afterSetLabel:function(e){this._syncLabelUI()}}});e.Rating=$,e.StarRating=$},"2.0.0pr5",{requires:["widget-htmlparser","widget-uievents","aui-component","aui-node-base"],skinnable:!0});
