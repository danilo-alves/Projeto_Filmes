YUI.add("aui-ace-autocomplete-list",function(e,t){var n=e.Lang,r=e.Array,i=e.Do,s=e.getClassName,o="data-index",t="ace-autocomplete-list",u="container",a=".",f="empty",l="",c="entry",h="highlighted",p="list",d="loading",v="offsetHeight",m="previous",g="region",y="results",b="selected",w=" ",E="visible",S="ace-autocomplete",x=s(S,c),T=s(S,c,u),N=s(S,c,u,h),C=s(S,c,f),k=s(S,c,d),L=s(S,c,d),A=s(S,y),O=a+T,M=O+a+b,_=M+w+a+x,D=40,P=35,H=34,B=33,j=36,F=38,I=5,q=20,R=e.Component.create({NAME:t,NS:t,ATTRS:{emptyMessage:{validator:n.isString,value:"No suggestions"},host:{validator:n.isObject},listNode:{value:null},loadingMessage:{validator:n.isString,value:"Loading"},results:{validator:n.isArray},selectedEntry:{getter:"_getSelectedEntry"}},AUGMENTS:[e.AceEditor.AutoCompleteBase,e.WidgetAutohide],CSS_PREFIX:S,EXTENDS:e.Overlay,HTML_PARSER:{listNode:a+A},prototype:{bindUI:function(){var e=this;e.on("addSuggestion",e.hide,e),e.on("cursorChange",e._onCursorChange,e),e.on("cursorOut",e.hide,e),e.on("insertText",e._onInsertText,e),e.on("match",e._onMatch,e),e.on("removeText",e._onRemoveText,e),e.on("resultsChange",e._onResultsChange,e),e.on("resultsError",e._setEmptyResults,e),e.on("showLoadingMessage",e._onShowLoadingMessage,e),e.on("visibleChange",e._onVisibleChange,e)},renderUI:function(){var e=this,t=e.get("listNode");t||(t=e._createListNode()),t.delegate("click",e._handleResultListClick,O,e),t.delegate("mouseenter",e._onMouseEnter,O,e),t.delegate("mouseleave",e._onMouseLeave,O),e._autoCompleteResultsList=t},_createListNode:function(){var t=this,n=e.Node.create(t.TPL_LIST);return t.get("contentBox").append(n),n},_getEntriesPerPage:function(){var e=this,t=e._entriesPerPage;if(!t){var n=e._autoCompleteResultsList,r=n.one(O).get(v),i=n.get(v);t=Math.floor(i/r),e._entriesPerPage=t}return t},_getSelectedEntry:function(){var e=this,t,n=e._autoCompleteResultsList.one(_);return n&&(t=n.text()),t},_handleArrows:function(e){var t=this,n;e===F?n=m:e===D&&(n="next");if(n){var r=t._autoCompleteResultsList,s=r.one(M);if(s){var o=s[n](O);if(o){s.removeClass(b),o.addClass(b);var u=r.get(g),a=o.get(g);n===m?a.top<u.top?o.scrollIntoView(!0):a.top>u.bottom&&o.scrollIntoView():a.top+a.height>u.bottom?o.scrollIntoView():a.top+a.height<u.top&&o.scrollIntoView(!0)}}return new i.Halt(null)}},_handleKey:function(e,t,n){var r=this,i;if(r.get(E))if(n===F||n===D)i=r._handleArrows(n);else if(n===B||n===H)i=r._handlePageUpDown(n);else if(n===P||n===j)i=r._handleStartEnd(n);return i},_handlePageUpDown:function(e){var t=this,r=t._autoCompleteResultsList,s=t._getEntriesPerPage(),u=r.one(M),a=n.toInt(u.attr(o)),f,c=l,h=!1;e===B?(f=a-s,h=!0):e===H&&(f=a+s,c=":last-child");var p=r.one(O+"["+o+'="'+f+'"]');return p||(p=r.one(O+c)),u!==p&&(u.removeClass(b),p.addClass(b),p.scrollIntoView(h)),new i.Halt(null)},_handleResultListClick:function(e){var t=this,n=e.currentTarget,r=t._autoCompleteResultsList.one(M);n!==r&&(r.removeClass(b),n.addClass(b));var i=n.text();t._addSuggestion(i),t.fire("entrySelected",{content:i})},_handleStartEnd:function(e){var t=this,n,r=!1,s=t._autoCompleteResultsList;e===P?n=s.one(O+":last-child"):e===j&&(n=s.one(O),r=!0);var o=s.one(M);return n!==o&&(o.removeClass(b),n.addClass(b),n.scrollIntoView(r)),new i.Halt(null)},_onCursorChange:function(e){var t=this;t.get(E)||e.preventDefault()},_onInsertText:function(e){var t=this;e.startRow!==e.endRow&&t.get(E)&&t.hide()},_onMatch:function(e){var t=this;if(e.match){var n=e.coords;t.set("xy",[n.pageX+I,n.pageY+q])}else t.get(E)&&t.hide()},_onMouseEnter:function(e){e.currentTarget.addClass(N)},_onMouseLeave:function(e){e.currentTarget.removeClass(N)},_onRemoveText:function(e){var t=this;t.get(E)&&t.hide()},_onResultsChange:function(e){var t=this,i=t._autoCompleteResultsList;i.empty();var s=e.newVal,o=t.TPL_ENTRY;r.each(s,function(e,t){i.appendChild(n.sub(o,{index:t,value:e}))});var u=i.one(O);u?(u.addClass(b),t.get(E)||t.show()):t.get(E)&&t.hide()},_onShowLoadingMessage:function(e){var t=this,r=t._autoCompleteResultsList;r.empty(),r.appendChild(n.sub(t.TPL_LOADING,{label:t.get("loadingMessage")})),t.get(E)||t.show()},_onVisibleChange:function(e){var t=this;e.newVal?t._overwriteCommands():t._removeAutoCompleteCommands()},_setEmptyResults:function(){var e=this;e.set("results",[])},TPL_ENTRY:'<li class="'+T+'" data-index="{index}">'+'<span class="'+x+'">{value}</span>'+"</li>",TPL_LIST:'<ul class="'+A+'"/>',TPL_LOADING:'<li class="'+T+'">'+'<span class="aui-icon-loading '+k+'">{label}</span>'+"</li>",TPL_RESULTS_EMPTY:'<li class="'+T+'">'+'<span class="'+C+'">{label}</span>'+"</li>"}});e.AceEditor.AutoCompleteList=R,e.AceEditor.AutoComplete=R},"2.0.0pr5",{requires:["aui-ace-autocomplete-base","overlay","widget-autohide"],skinnable:!0});
