YUI.add("aui-ace-autocomplete-freemarker",function(e,t){var n=e.Lang,r=e.Array,i=e.Object,s=["flush","recover","fallback","local","break","lt","case","global","if","compress","escape","assign","elseif","noescape","setting","list","else","switch","include","recurse","rt","ftl","macro","stop","nt","visit","attempt","nested","import","default","return","t","function"],o=0,u=1,a=/<#[\w.]*>?$/,f=/\$\{[\w., ()"]*\}?$/,l=-1,c=0,h="all",p=".",d="",v="responseData",m="variables",t="aui-ace-autocomplete-freemarker",g=e.Component.create({NAME:t,NS:t,ATTRS:{host:{validator:n.isObject},variables:{validator:n.isObject}},EXTENDS:e.Base,prototype:{initializer:function(t){var n=this;n._tstree=new e.TernarySearchTree},getMatch:function(e){var t=this,n,r;return(r=e.lastIndexOf("<"))>=0?(e=e.substring(r),a.test(e)&&(n={content:e.substring(2),start:r,type:o})):(r=e.lastIndexOf("$"))>=0&&(e=e.substring(r),f.test(e)&&(n={content:e.substring(2),start:r,type:u})),n},getResults:function(e,t,n){var r=this,i=r._tstree,a=e.type;if(a===o){var f=s,l=e.content;l.length&&(r._lastTSTLoad!==o&&r._addDirectives(),f=i.prefixSearch(l)),t(f)}else if(a===u){var c=r._getVariableMatches(e.content);t(c)}},getSuggestion:function(e,t){var n=this,r=t||d;if(t){var i=e.type;if(i===o)e.content&&t.indexOf(e.content)===0&&(r=t.substring(e.content.length));else if(i===u){var s=e.content.split(p),a=s[s.length-1];a&&t.indexOf(a)===0&&(r=t.substring(a.length))}}return r},_addData:function(e){var t=this,n=t._tstree;n.empty(),r.each(e,function(e,t){n.add(e)})},_addDirectives:function(){var e=this;e._addData(s),e._lastTSTLoad=o},_getVariableMatches:function(e){var t=this,s=e.split(p),o=t.get(m),a=s[s.length-1];s.length-=1;var f;if(s.length>0)for(var l=0;l<s.length;l++)f=s[l],n.isObject(o)&&(o=o[f]);var c=[];if(n.isObject(o)){r.each(i.keys(o),function(e,t){c.push(e)});if(a){var h=t._tstree;h.empty(),r.each(c,function(e,t){h.add(e)}),c=h.prefixSearch(a),t._lastTSTLoad=u}}return c}}});g.DIRECTIVES=s,e.AceEditor.AutoCompleteFreemarker=g},"2.0.0pr5",{requires:["aui-ace-autocomplete-base","aui-search-tst"]});
